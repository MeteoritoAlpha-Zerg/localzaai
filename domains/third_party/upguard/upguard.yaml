# UpGuard
name: "upguard"
category: "Cyber Risk Intelligence"
description: "Create an API integration with UpGuard to fetch cybersecurity risk ratings, security issue insights, and vendor risk intelligence"

specs:
  - description: |
      The UpGuard Connector is able to authenticate with UpGuard per its implementation in the code 
      environment only
    preconditions: |
      This spec has no strict preconditions
    postconditions: |
      The UpGuard connector is able to authenticate properly with an UpGuard instance;
      The UpGuard connector config is of type ConnectorConfig and not AlertProviderConnectorConfig;

  - description: |
      UpGuard Connector is able to list UpGuard vendors and domains per user of get_query_target_options
    preconditions: |
      A valid authenticated session with UpGuard
    postconditions: |
      Connector successfully enumerates vendors and domains to populate the target options of the UpGuardTarget;

  - description: |
      UpGuard Connector is able to retrieve vendor and domain information
    preconditions: |
      A valid authenticated session with UpGuard
    postconditions: |
      Per the configuration as contained in UpGuardTarget as provided to UpGuardConnectorTools, it is possible
      to get a list of vendors and domains along with their respective metadata and other relevant details
      as may be relevant for cyber risk intelligence and vendor risk analysis;
      Ensure that the respective get_upguard_vendors function in the UpGuardConnectorTools is not hardcoding
      any return values;

  - description: |
      UpGuard Connector is able to retrieve security ratings and risk data from selected vendors and domains
    preconditions: |
      A valid authenticated session with UpGuard
    postconditions: |
      Connector successfully retrieves security ratings and risk data for the selected vendors and domains provided as params
      to the risk tools, supporting cybersecurity risk assessment and vendor risk intelligence

  - description: |
      UpGuard Connector is able to retrieve security issues and vulnerabilities from UpGuard platform
    preconditions: |
      A valid authenticated session with UpGuard
    postconditions: |
      Connector successfully retrieves security issues and vulnerabilities from UpGuard for risk analysis and remediation

tests:
  - description: |
      This checks to see that the connector is able to return a listing of tools
    preconditions: |
      A data connector implementation per the provided interfaces
    postconditions: |
      The data connector is able to provide a list of supported tools and interfaces
    function_to_run: !python/file 1-test_tools_interface.py

  - description: |
      This checks that the connector can successfully verify its connection
    preconditions: |
      A connector implementation adhering to ConnectorInterface is available as 'connector'
    postconditions: |
      The check_connection method returns True if the connector is correctly configured
    function_to_run: !python/file 2-test_connector_check_connection.py

  - description: |
      get_query_target_options enumerates UpGuard vendors and domains
    preconditions: |
      An existing UpGuard instance with valid API credentials
    postconditions: |
      Possible to retrieve the list of UpGuard vendors and domains using get_query_target_options
      and to then use this to set the options in a given UpGuardConnectorConfig which is 
      subclassed from ConnectorConfig - adheres to example API response in query_target_options.py;
      These must be real vendors and domains, and not simulated;
    function_to_run: !python/file 3-test_query_target_options.py

  - description: |
      List UpGuard vendors and domains for selected targets
    preconditions: |
      An existing UpGuard instance with valid API credentials
    postconditions: |
      Possible to retrieve the list of UpGuard vendors and domains by way of connector tools;
      This list includes details of the vendors and domains including metadata and risk scores; 
      These must be real vendors and domains, and not simulated;
    function_to_run: !python/file 4-test_list_vendors.py

  - description: |
      Retrieve security ratings and risk data from selected UpGuard vendors and domains
    preconditions: |
      An existing UpGuard instance with valid API credentials
    postconditions: |
      Possible to retrieve security ratings and risk data from the selected UpGuard vendors and domains as passed as params to the connector tools;
      This includes security ratings and cyber risk intelligence for analysis; 
      These must be real ratings and risk data, and not simulated;
    function_to_run: !python/file 5-test_security_ratings.py

  - description: |
      Retrieve security issues and vulnerabilities from UpGuard platform
    preconditions: |
      An existing UpGuard instance with valid API credentials
    postconditions: |
      Possible to retrieve security issues and vulnerabilities from UpGuard platform;
      This includes security risks and vulnerability data for analysis and remediation; 
      These must be real security issues and vulnerabilities, and not simulated;
    function_to_run: !python/file 6-test_security_issues.py

connector_references: 
  - description: "UpGuard logo"
    file_path: "assets/upguard.png"
    environment_path: "connectors/upguard/upguard.png"
    format: "svg"
    required: true
    read_only: true

user_references: []

configs:
  - name: "upguard_url"
    description: "The base URL of the UpGuard API (typically https://cyber-risk.upguard.com), note this should be included as url in UpGuardConnectorConfig"
    value: !env/var 

  - name: "upguard_api_key"
    description: "API key for authenticating with UpGuard API, note this should be included as api_key in UpGuardConnectorConfig"
    value: !env/var 

  - name: "upguard_api_request_timeout"
    description: "Request timeout in seconds"
    value: 120

  - name: "upguard_api_max_retries"
    description: "Number of times to retry API requests upon failure"
    value: 3

  - name: "upguard_verify_ssl"
    description: "Whether to verify SSL certificates"
    value: true

  - name: "upguard_max_results"
    description: "Maximum number of results to return per API call"
    value: 1000

  - name: "additional considerations"
    description: |
      Additional considerations for the generation of specifically the UpGuard connector 
      with regards to the connector framework as provided - please keep these strongly in mind
    value: [
      "UpGuardConnectorConfig should derive from ConnectorConfig, this is not a connector of type AlertProviderConnectorConfig config",
      "authentication should not be a tool, tools should handle authentication when used (so should not be explicitly exposed)",
      "utilize the query target options to determine which vendors and domains are valid for the target, and then use the target to select which vendors and domains to actually pull data from for the respective tools as shown in the unit tests",
      "support UpGuard's API key authentication method",
      "handle rate limiting appropriately for UpGuard API constraints",
      "support UpGuard's security scoring methodology and risk assessment framework",
      "integrate with UpGuard's vendor risk management and domain monitoring capabilities"
    ]
# !UpGuard