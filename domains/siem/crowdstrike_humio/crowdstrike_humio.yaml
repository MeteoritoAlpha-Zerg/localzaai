# CrowdStrike Humio
name: "crowdstrike_humio"
category: "Log Analytics"
description: "Create an API integration with CrowdStrike Humio for log ingestion and search queries"

specs:
  - description: |
      The CrowdStrike Humio Connector is able to authenticate with Humio API per its implementation in the code 
      environment only
    preconditions: |
      This spec has no strict preconditions
    postconditions: |
      The CrowdStrike Humio connector is able to authenticate properly with the Humio API;
      The CrowdStrike Humio connector config is of type ConnectorConfig and not AlertProviderConnectorConfig;

  - description: |
      CrowdStrike Humio Connector is able to list available repositories and data sources per user of get_query_target_options
    preconditions: |
      A valid authenticated session with Humio API
    postconditions: |
      Connector successfully enumerates repositories and data sources to populate the target options of the CrowdStrikeHumioTarget;

  - description: |
      CrowdStrike Humio Connector is able to list repository information and data sources
    preconditions: |
      A valid authenticated session with Humio API
    postconditions: |
      Per the configuration as contained in CrowdStrikeHumioTarget as provided to CrowdStrikeHumioConnectorTools, it is possible
      to get a list of repositories and data sources along with their respective metadata and log ingestion information
      as may be relevant for log analytics;
      Ensure that the respective get_humio_repositories function in the CrowdStrikeHumioConnectorTools is not hardcoding
      any return values;

  - description: |
      CrowdStrike Humio Connector is able to execute search queries against selected repositories
    preconditions: |
      A valid authenticated session with Humio API
    postconditions: |
      Connector successfully executes log search queries and retrieves log data
      from the selected repositories provided as parameters to the query tool

  - description: |
      CrowdStrike Humio Connector is able to perform log ingestion and data streaming
    preconditions: |
      A valid authenticated session with Humio API
    postconditions: |
      Connector successfully ingests log data and performs streaming analytics
      for comprehensive log management and real-time analysis

tests:
  - description: |
      This checks to see that the connector is able to return a listing of tools
    preconditions: |
      A data connector implementation per the provided interfaces
    postconditions: |
      The data connector is able to provide a list of supported tools and interfaces
    function_to_run: !python/file 1-test_tools_interface.py

  - description: |
      This checks that the connector can successfully verify its connection
    preconditions: |
      A connector implementation adhering to ConnectorInterface is available as 'connector'
    postconditions: |
      The check_connection method returns True if the connector is correctly configured
    function_to_run: !python/file 2-test_connector_check_connection.py

  - description: |
      get_query_target_options enumerates CrowdStrike Humio repositories and data sources
    preconditions: |
      An existing CrowdStrike Humio API token
    postconditions: |
      Possible to retrieve the list of Humio repositories and data sources using get_query_target_options
      and to then use this to set the options in a given CrowdStrikeHumioConnectorConfig which is 
      subclassed from ConnectorConfig - adheres to example API response in query_target_options.py;
      These must be real repositories and data sources, and not simulated;
    function_to_run: !python/file 3-test_query_target_options.py

  - description: |
      List CrowdStrike Humio repositories for selected targets
    preconditions: |
      An existing CrowdStrike Humio API token
    postconditions: |
      Possible to retrieve the list of Humio repositories by way of connector tools;
      This list includes metadata and ingestion information for log analytics; 
      These must be real repositories, and not simulated;
    function_to_run: !python/file 4-test_list_repositories.py

  - description: |
      Execute search queries against selected Humio repositories
    preconditions: |
      An existing CrowdStrike Humio API token with access to repository data
    postconditions: |
      Possible to execute log search queries and retrieve log data from selected repositories;
      This query returns actual log search results from the target repositories; 
      These must be real log search results, and not simulated;
    function_to_run: !python/file 5-test_search_queries.py

  - description: |
      Perform log ingestion and streaming analytics
    preconditions: |
      An existing CrowdStrike Humio API token with ingestion permissions
    postconditions: |
      Possible to ingest log data and perform streaming analytics operations;
      The ingestion should support real-time log management use cases;
      Results must demonstrate actual log ingestion capabilities;
    function_to_run: !python/file 6-test_log_ingestion.py

connector_references: 
  - description: "CrowdStrike Humio logo"
    file_path: "assets/crowdstrike_humio.png"
    environment_path: "connectors/crowdstrike_humio/crowdstrike_humio.png"
    format: "png"
    required: true
    read_only: true

user_references: []

configs:
  - name: "humio_api_token"
    description: "API Token for authenticating with CrowdStrike Humio, note this should be included as api_token in CrowdStrikeHumioConnectorConfig"
    value: !env/var 

  - name: "humio_base_url"
    description: "Base URL for CrowdStrike Humio instance, note this should be included as base_url in CrowdStrikeHumioConnectorConfig"
    value: !env/var 

  - name: "humio_organization"
    description: "Organization identifier for CrowdStrike Humio, note this should be included as organization in CrowdStrikeHumioConnectorConfig"
    value: !env/var 

  - name: "humio_api_request_timeout"
    description: "Request timeout in seconds"
    value: 60

  - name: "humio_api_max_retries"
    description: "Number of times to retry API requests upon failure"
    value: 3

  - name: "humio_max_search_results"
    description: "Maximum number of search results to retrieve per query"
    value: 10000

  - name: "humio_search_timeout"
    description: "Search query timeout in seconds"
    value: 300

  - name: "humio_ingestion_batch_size"
    description: "Batch size for log ingestion operations"
    value: 1000

  - name: "humio_query_language"
    description: "Default query language for searches (humio, lucene)"
    value: "humio"

  - name: "additional considerations"
    description: |
      Additional considerations for the generation of specifically the CrowdStrike Humio connector 
      with regards to the connector framework as provided - please keep these strongly in mind
    value: [
      "CrowdStrikeHumioConnectorConfig should derive from ConnectorConfig, this is not a connector of type AlertProviderConnectorConfig config",
      "authentication should not be a tool, tools should handle authentication when used (so should not be explicitly exposed)",
      "utilize the query target options to determine which repositories and data sources are valid for the target, and then use the target to select which data sources to actually pull data from for the respective tools as shown in the unit tests",
      "focus on log ingestion, search queries, and streaming analytics capabilities",
      "support both Humio Query Language (HQL) and Lucene query syntax for flexible log analysis",
      "handle both real-time log streaming and historical log search operations",
      "include repository management and data source configuration for comprehensive log analytics",
      "support time-based queries and log aggregation for operational intelligence"
    ]
# !CrowdStrike Humio