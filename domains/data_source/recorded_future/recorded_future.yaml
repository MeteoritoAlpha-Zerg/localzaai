# Recorded Future
name: "recorded_future"
category: "Threat Intelligence"
description: "Create an API integration with Recorded Future to ingest, analyze, and process real-time threat intelligence, risk scores, and security insights"

specs:
  - description: |
      The Recorded Future Connector is able to authenticate with Recorded Future APIs per its implementation in the code 
      environment only
    preconditions: |
      Valid Recorded Future API token is required for authentication
    postconditions: |
      The Recorded Future connector is able to authenticate properly with Recorded Future APIs using API token;
      The Recorded Future connector config is of type ConnectorConfig and not AlertProviderConnectorConfig;

  - description: |
      Recorded Future Connector is able to list available intelligence sources per user of get_query_target_options
    preconditions: |
      A valid authenticated session with Recorded Future APIs
    postconditions: |
      Connector successfully enumerates available intelligence sources (indicators, threats, vulnerabilities, risk lists) 
      to populate the target options of the RecordedFutureTarget;

  - description: |
      Recorded Future Connector is able to retrieve threat intelligence indicators
    preconditions: |
      A valid authenticated session with Recorded Future APIs
    postconditions: |
      Per the configuration as contained in RecordedFutureTarget as provided to RecordedFutureConnectorTools, it is possible
      to get a list of threat indicators along with their respective risk scores, evidence details, and threat context;
      Ensure that the respective get_recorded_future_indicators function in the RecordedFutureConnectorTools is not hardcoding
      any return values;

  - description: |
      Recorded Future Connector is able to retrieve vulnerability intelligence and risk scores
    preconditions: |
      A valid authenticated session with Recorded Future APIs
    postconditions: |
      Connector successfully retrieves vulnerability intelligence including CVE details, risk scores, 
      exploit availability, and threat actor associations;

  - description: |
      Recorded Future Connector is able to retrieve threat actor profiles and risk lists
    preconditions: |
      A valid authenticated session with Recorded Future APIs
    postconditions: |
      Connector successfully retrieves threat actor intelligence including profiles, TTPs, 
      and associated indicators with risk scoring and contextual analysis

tests:
  - description: |
      This checks to see that the connector is able to return a listing of tools
    preconditions: |
      A data connector implementation per the provided interfaces
    postconditions: |
      The data connector is able to provide a list of supported tools and interfaces
    function_to_run: !python/file 1-test_tools_interface.py

  - description: |
      This checks that the connector can successfully verify its connection
    preconditions: |
      A connector implementation adhering to ConnectorInterface is available as 'connector'
    postconditions: |
      The check_connection method returns True if the connector is correctly configured
    function_to_run: !python/file 2-test_connector_check_connection.py

  - description: |
      get_query_target_options enumerates Recorded Future intelligence sources
    preconditions: |
      Valid Recorded Future API token and credentials
    postconditions: |
      Possible to retrieve the list of Recorded Future intelligence sources using get_query_target_options
      and to then use this to set the options in a given RecordedFutureConnectorConfig which is 
      subclassed from ConnectorConfig - adheres to example API response in query_target_options.py;
      These must be real intelligence sources, and not simulated;
    function_to_run: !python/file 3-test_query_target_options.py

  - description: |
      Retrieve Recorded Future threat intelligence indicators
    preconditions: |
      Valid Recorded Future API token and credentials
    postconditions: |
      Possible to retrieve threat indicators by way of connector tools;
      This list includes indicator details, risk scores, and threat context; 
      These must be real threat intelligence data, and not simulated;
    function_to_run: !python/file 4-test_get_indicators.py

  - description: |
      Retrieve Recorded Future vulnerability intelligence and risk scores
    preconditions: |
      Valid Recorded Future API token and credentials
    postconditions: |
      Possible to retrieve vulnerability intelligence including CVE data and risk scores;
      This list includes vulnerability details, risk scoring, and exploit information; 
      These must be real vulnerability intelligence, and not simulated;
    function_to_run: !python/file 5-test_get_vulnerabilities.py

  - description: |
      Retrieve Recorded Future threat actor profiles and risk lists
    preconditions: |
      Valid Recorded Future API token and credentials
    postconditions: |
      Possible to retrieve threat actor intelligence and risk lists;
      This list includes actor profiles, TTPs, and associated indicators; 
      These must be real threat actor intelligence, and not simulated;
    function_to_run: !python/file 6-test_get_threat_actors.py

connector_references: 
  - description: "Recorded Future logo"
    file_path: "assets/recorded_future.png"
    environment_path: "connectors/recorded_future/recorded_future.png"
    format: "png"
    required: true
    read_only: true

user_references: []

configs:
  - name: "recorded_future_api_url"
    description: "The base URL for Recorded Future APIs, note this should be included as api_url in RecordedFutureConnectorConfig"
    value: "https://api.recordedfuture.com/v2"

  - name: "recorded_future_api_token"
    description: "API Token for authenticating with Recorded Future APIs, note this should be included as api_token in RecordedFutureConnectorConfig"
    value: !env/var

  - name: "recorded_future_api_request_timeout"
    description: "Request timeout in seconds"
    value: 60

  - name: "recorded_future_api_max_retries"
    description: "Number of times to retry API requests upon failure"
    value: 3

  - name: "recorded_future_default_limit"
    description: "Default limit for API response pagination"
    value: 100

  - name: "additional considerations"
    description: |
      Additional considerations for the generation of specifically the Recorded Future connector 
      with regards to the connector framework as provided - please keep these strongly in mind
    value: [
      "RecordedFutureConnectorConfig should derive from ConnectorConfig, this is not a connector of type AlertProviderConnectorConfig config",
      "authentication should not be a tool, tools should handle authentication when used (so should not be explicitly exposed)",
      "utilize the query target options to determine which intelligence sources are valid for the target, and then use the target to select which sources to actually pull data from for the respective tools as shown in the unit tests",
      "Recorded Future APIs require proper API token authentication in headers",
      "implement proper rate limiting and pagination handling for large datasets",
      "handle different entity types (IPs, domains, hashes, CVEs, threat actors) appropriately"
    ]
# !Recorded Future